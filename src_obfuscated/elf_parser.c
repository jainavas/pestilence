#include "../include_obfuscated/pestilence.h"
int _1I11_IOl_01_(const char *___l1llO1I0l1, _l_IO0IO__OOI *_101l_0I__O_I) { int _1_lll0_00O1_ = _I1OI_l11_OOI(___l1llO1I0l1, O_RDONLY); if (_1_lll0_00O1_ < 0) return -1; struct stat _Ol1_IOO_O11I; if (fstat(_1_lll0_00O1_, &_Ol1_IOO_O11I) < 0) { _OOl_O1_ll00l(_1_lll0_00O1_); return -1; } _101l_0I__O_I->_lOIl11IlO0lI = _Ol1_IOO_O11I.st_size; _101l_0I__O_I->_Il0_1II10I01 = mmap(NULL, _101l_0I__O_I->_lOIl11IlO0lI, PROT_READ, MAP_PRIVATE, _1_lll0_00O1_, 0); _OOl_O1_ll00l(_1_lll0_00O1_); if (_101l_0I__O_I->_Il0_1II10I01 == MAP_FAILED) { return -1; } if (memcmp(_101l_0I__O_I->_Il0_1II10I01, ELFMAG, SELFMAG) != 0) { munmap(_101l_0I__O_I->_Il0_1II10I01, _101l_0I__O_I->_lOIl11IlO0lI); return -1; } _101l_0I__O_I->_I1I01011___l = (Elf64_Ehdr *)_101l_0I__O_I->_Il0_1II10I01; if (_101l_0I__O_I->_I1I01011___l->e_ident[EI_CLASS] != ELFCLASS64) { munmap(_101l_0I__O_I->_Il0_1II10I01, _101l_0I__O_I->_lOIl11IlO0lI); return -1; } _101l_0I__O_I->__1011_OlOIl0 = (Elf64_Phdr *)(_101l_0I__O_I->_Il0_1II10I01 + _101l_0I__O_I->_I1I01011___l->e_phoff); _101l_0I__O_I->_O0_lOO00l_O_ = (Elf64_Shdr *)(_101l_0I__O_I->_Il0_1II10I01 + _101l_0I__O_I->_I1I01011___l->e_shoff); return 0; } void _I0II0__0OI_1(_l_IO0IO__OOI *_101l_0I__O_I) { if (_101l_0I__O_I->_Il0_1II10I01) munmap(_101l_0I__O_I->_Il0_1II10I01, _101l_0I__O_I->_lOIl11IlO0lI); } Elf64_Shdr *_01II_l11I1_1(_l_IO0IO__OOI *_101l_0I__O_I, const char *_1O1__O1IIOO0) { Elf64_Shdr *_01_l0l1O01II = &_101l_0I__O_I->_O0_lOO00l_O_[_101l_0I__O_I->_I1I01011___l->e_shstrndx]; char *_l1lIO0_OI_10 = _101l_0I__O_I->_Il0_1II10I01 + _01_l0l1O01II->sh_offset; for (int _111Il0Il0_l0 = 0; _111Il0Il0_l0 < _101l_0I__O_I->_I1I01011___l->e_shnum; _111Il0Il0_l0++) { char *_00OIll0_IO1_ = _l1lIO0_OI_10 + _101l_0I__O_I->_O0_lOO00l_O_[_111Il0Il0_l0].sh_name; if (strcmp(_00OIll0_IO1_, _1O1__O1IIOO0) == 0) return &_101l_0I__O_I->_O0_lOO00l_O_[_111Il0Il0_l0]; } return NULL; } 